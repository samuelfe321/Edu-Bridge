<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>EDU-BRIDGE | Dashboard</title>
    <link rel="stylesheet" href="css/style.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
    <style>
      :root {
        --primary: #0066cc;
        --bg: #fff;
        --text: #222;
        --border: #ddd;
      }
      body.dark-mode {
        --bg: #111;
        --text: #eee;
        --border: #333;
      }
      body {
        background: var(--bg);
        color: var(--text);
        font-family: system-ui, sans-serif;
        margin: 0;
      }

      .top-bar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: var(--primary);
        color: white;
        padding: 0.8rem 1.2rem;
        border-radius: 8px;
        margin: 1rem;
        flex-wrap: wrap;
      }
      .user-info {
        display: flex;
        align-items: center;
        gap: 0.8rem;
      }
      .avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: #fff;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        color: var(--primary);
      }
      .hamburger {
        display: none;
        cursor: pointer;
        font-size: 1.5rem;
        color: white;
      }
      .dropdown {
        position: relative;
      }
      .dropdown-content {
        display: none;
        position: absolute;
        right: 0;
        top: 100%;
        background: var(--bg);
        min-width: 220px;
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        border-radius: 6px;
        z-index: 1000;
        border: 1px solid var(--border);
      }
      .dropdown.open .dropdown-content {
        display: block;
      }
      .dropdown-content a {
        color: var(--text);
        padding: 12px 16px;
        text-decoration: none;
        display: block;
        transition: 0.2s;
      }
      .dropdown-content a:hover {
        background: var(--primary);
        color: white;
      }

      /* Desktop nav container */
      #desktop-nav {
        display: flex;
        gap: 1.8rem;
        align-items: center;
      }
      #desktop-nav a {
        color: white;
        text-decoration: none;
        font-weight: 500;
      }

      /* Accessibility toolbar - desktop only */
      #accessibility-toolbar-inline {
        display: none;
        gap: 12px;
        align-items: center;
      }
      #accessibility-toolbar-inline button {
        background: rgba(255,255,255,0.2);
        color: white;
        width: 42px;
        height: 42px;
        border-radius: 50%;
        border: none;
        font-size: 1.2rem;
        cursor: pointer;
        transition: 0.3s;
      }
      #accessibility-toolbar-inline button:hover {
        background: white;
        color: var(--primary);
      }

      .dashboard { max-width: 1200px; margin: 2rem auto; padding: 0 20px; }
      .progress-overview { background: #f0f8ff; padding: 1.5rem; border-radius: 12px; text-align: center; margin-bottom: 1.5rem; border: 1px solid #b3e0ff; }
      .circular-progress { width: 120px; height: 120px; border-radius: 50%; background: conic-gradient(var(--primary) 0% 68%, #e0e0e0 68% 100%); display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem; position: relative; }
      .circular-progress::before { content: "68%"; font-size: 1.5rem; font-weight: bold; color: var(--primary); }
      .circular-progress::after { content: ""; position: absolute; width: 100px; height: 100px; background: white; border-radius: 50%; }

      .quick-actions { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 1.5rem; }
      .action-btn { background: white; border: 2px solid var(--border); padding: 1rem; border-radius: 10px; text-align: center; cursor: pointer; transition: 0.3s; }
      .action-btn:hover { transform: translateY(-3px); box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1); }

      .featured-video { background: #111; color: white; padding: 1.5rem; border-radius: 12px; margin-bottom: 1.5rem; text-align: center; }
      .video-placeholder { background: #333; height: 200px; border-radius: 8px; margin: 1rem 0; display: flex; align-items: center; justify-content: center; font-size: 3rem; }

      .stats-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem; margin-bottom: 1.5rem; }
      .stat-card { background: white; border: 2px solid var(--border); padding: 1rem; border-radius: 10px; text-align: center; }
      .stat-card h3 { margin: 0.5rem 0 0; font-size: 1.8rem; color: var(--primary); }

      .nav-tabs { display: flex; gap: 10px; margin-bottom: 1.5rem; flex-wrap: wrap; border-bottom: 2px solid var(--border); }
      .nav-tab { padding: 10px 20px; background: none; border: none; font-weight: 600; cursor: pointer; border-radius: 6px 6px 0 0; }
      .nav-tab.active { background: var(--primary); color: white; }

      .tab-content { display: none; }
      .tab-content.active { display: block; }

      .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 1.5rem; }
      .card { background: white; border: 2px solid var(--border); border-radius: 10px; padding: 1.2rem; transition: 0.3s; }
      .card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1); }
      .badge { display: inline-flex; align-items: center; gap: 0.5rem; background: #e6f7ff; color: var(--primary); padding: 0.3rem 0.6rem; border-radius: 20px; font-size: 0.9rem; margin-top: 0.5rem; }

      @media (max-width: 768px) {
        .hamburger { display: block; }
        #desktop-nav, #accessibility-toolbar-inline { display: none !important; }
        .stats-grid { grid-template-columns: 1fr 1fr; }
        .quick-actions { grid-template-columns: 1fr; }
      }
      @media (min-width: 769px) {
        #accessibility-toolbar-inline { display: flex; }
      }
    </style>
  </head>
  <body>
    <div id="loader" style="position:fixed;top:0;left:0;width:100%;height:4px;background:rgba(0,0,0,0.1);z-index:9999;overflow:hidden;">
      <div id="progress" style="height:100%;width:0;background:var(--primary);transition:width 0.6s ease;"></div>
    </div>

    <div class="top-bar">
      <div class="user-info">
        <div class="avatar" id="avatar">CO</div>
        <div>
          <div id="welcome-text" style="font-weight:600">Welcome, Guest</div>
          <div style="font-size:0.85rem;opacity:0.9">Student</div>
        </div>
      </div>

      <div style="display:flex;gap:1.5rem;align-items:center;">
        <!-- Desktop Navigation Links (created by JS) -->
        <div id="desktop-nav"></div>

        <!-- Desktop Accessibility Toolbar -->
        <div id="accessibility-toolbar-inline">
          <button id="dark-mode-toggle" aria-label="Toggle dark mode"><i class="fas fa-moon"></i></button>
          <button id="tts-toggle" aria-label="Toggle text-to-speech"><i class="fas fa-volume-up"></i></button>
        </div>

        <!-- Hamburger Menu -->
        <div class="dropdown" id="user-menu">
          <div class="hamburger" aria-label="Menu" aria-expanded="false"><i class="fas fa-bars"></i></div>
          <nav class="dropdown-content">
            <ul>
              <li><a href="#" id="change-pwd"><i class="fas fa-key"></i> Change Password</a></li>
              <li><a href="#" id="my-courses"><i class="fas fa-book-open"></i> My Courses</a></li>
              <li><a href="#" id="my-books"><i class="fas fa-book"></i> My Books</a></li>
              <li><a href="#" id="my-blogs"><i class="fas fa-blog"></i> My Blogs</a></li>
              <li><a href="#" id="my-videos"><i class="fas fa-video"></i> Videos</a></li>
              <li><a href="#" id="logout"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
              <li>
                <div class="accessibility-toolbar-inline">
                  <button id="mobile-dark-mode" aria-label="Toggle dark mode"><i class="fas fa-moon"></i> Dark Mode</button>
                  <button id="mobile-tts" aria-label="Toggle text-to-speech"><i class="fas fa-volume-up"></i> Text-to-Speech</button>
                </div>
              </li>
            </ul>
          </nav>
        </div>
      </div>
    </div>

    <div
      class="dashboard"
      id="main-content"
      style="opacity: 0; transition: opacity 0.4s"
    >
      <!-- Progress Overview -->
      <div class="progress-overview">
        <h2>Overall Progress</h2>
        <div class="circular-progress"></div>
        <p>You're doing great! Keep it up!</p>
        <div class="badge"><i class="fas fa-fire"></i> 5-day streak</div>
      </div>

      <!-- Quick Actions -->
      <div class="quick-actions">
        <div class="action-btn" id="continue-course">
          <i
            class="fas fa-play-circle"
            style="font-size: 2rem; color: var(--primary)"
          ></i>
          <h3>Continue Learning</h3>
          <p>JavaScript Basics</p>
        </div>
        <div class="action-btn">
          <i class="fas fa-video" style="font-size: 2rem; color: #28a745"></i>
          <h3>Watch New Video</h3>
          <p>AI for Beginners</p>
        </div>
        <div class="action-btn">
          <i
            class="fas fa-certificate"
            style="font-size: 2rem; color: #ffc107"
          ></i>
          <h3>View Certificates</h3>
          <p>2 earned</p>
        </div>
      </div>

      <!-- Featured Video -->
      <div class="featured-video">
        <h2>Featured: Welcome to EDU-BRIDGE 2025</h2>
        <div class="video-placeholder">
          <i class="fas fa-play-circle"></i>
        </div>
        <p>Uploaded by <strong>Admin</strong> • 15:30</p>
      </div>

      <!-- Stats -->
      <div class="stats-grid">
        <div class="stat-card">
          <h3>3</h3>
          <p>Active Courses</p>
        </div>
        <div class="stat-card">
          <h3>75%</h3>
          <p>Avg. Progress</p>
        </div>
        <div class="stat-card">
          <h3>2</h3>
          <p>Certificates</p>
        </div>
        <div class="stat-card">
          <h3>5</h3>
          <p>Day Streak</p>
        </div>
      </div>

      <!-- Tabs -->
      <div class="nav-tabs">
        <button class="nav-tab active" data-tab="courses">Courses</button>
        <button class="nav-tab" data-tab="books">Books</button>
        <button class="nav-tab" data-tab="blogs">Blogs</button>
        <button class="nav-tab" data-tab="videos">Videos</button>
      </div>

      <!-- Tab Contents -->
      <section id="courses" class="tab-content active">
        <h2>My Courses</h2>
        <div class="grid" id="course-list"></div>
      </section>
      <section id="books" class="tab-content">
        <h2>My Books</h2>
        <div class="grid" id="book-list"></div>
      </section>
      <section id="blogs" class="tab-content">
        <h2>My Blogs</h2>
        <div class="grid" id="blog-list"></div>
      </section>
      <section id="videos" class="tab-content">
        <h2>Admin Videos</h2>
        <div class="grid" id="video-list"></div>
      </section>
    </div>

    <footer
      style="
        text-align: center;
        padding: 2rem;
        background: #111;
        color: #ddd;
        margin-top: 3rem;
      "
    >
      <p>© 2025 EDU-BRIDGE. All rights reserved.</p>
    </footer>

    <script src="js/accessibility.js"></script>
    <script>
      (() => {
        "use strict";
        const user = JSON.parse(localStorage.getItem("currentUser"));
        if (!user) { alert("Please log in first."); window.location.href = "user-login.html"; return; }

        document.getElementById("welcome-text").textContent = `Welcome, ${user.name}`;
        document.getElementById("avatar").textContent = user.name.split(" ").map(n => n[0]).join("").toUpperCase();

        // Progress loader
        const progress = document.getElementById("progress");
        const main = document.getElementById("main-content");
        let w = 0;
        const int = setInterval(() => {
          if (w >= 100) { clearInterval(int); document.getElementById("loader").remove(); main.style.opacity = "1"; }
          else { w += 2; progress.style.width = w + "%"; }
        }, 15);

        // Desktop nav
        const desktopNav = document.getElementById("desktop-nav");
        const links = [
          {id:"my-courses",icon:"book-open",text:"My Courses",tab:"courses"},
          {id:"my-books",icon:"book",text:"My Books",tab:"books"},
          {id:"my-blogs",icon:"blog",text:"My Blogs",tab:"blogs"},
          {id:"my-videos",icon:"video",text:"Videos",tab:"videos"},
          {id:"logout",icon:"sign-out-alt",text:"Logout",action:"logout"}
        ];
        links.forEach(l => {
          const a = document.createElement("a");
          a.href = "#"; a.id = l.id;
          a.innerHTML = `<i class="fas fa-${l.icon}"></i> ${l.text}`;
          a.addEventListener("click", e => {
            e.preventDefault();
            if (l.action === "logout") handleLogout();
            else document.querySelector(`.nav-tab[data-tab="${l.tab}"]`).click();
          });
          desktopNav.appendChild(a);
        });

        // Mobile menu
        const hamburger = document.querySelector(".hamburger");
        const dropdown = document.getElementById("user-menu");
        hamburger.addEventListener("click", e => {
          e.stopPropagation();
          dropdown.classList.toggle("open");
        });
        document.addEventListener("click", e => {
          if (!dropdown.contains(e.target)) dropdown.classList.remove("open");
        });

        // Mobile accessibility buttons forward to real ones
        document.getElementById("mobile-dark-mode")?.addEventListener("click", () => document.getElementById("dark-mode-toggle").click());
        document.getElementById("mobile-tts")?.addEventListener("click", () => document.getElementById("tts-toggle").click());

        // Tab switching
        document.querySelectorAll(".nav-tab").forEach((tab) => {
          tab.addEventListener("click", () => {
            document.querySelectorAll(".nav-tab").forEach((t) => {
              t.classList.remove("active");
              t.setAttribute("aria-selected", "false");
            });
            document
              .querySelectorAll(".tab-content")
              .forEach((c) => c.classList.remove("active"));
            tab.classList.add("active");
            tab.setAttribute("aria-selected", "true");
            document.getElementById(tab.dataset.tab).classList.add("active");
          });
        });

        // Data
        const courses = [
          { title: "Web Accessibility", progress: "75%" },
          { title: "JavaScript Basics", progress: "100%" },
          { title: "UX Design", progress: "40%" },
        ];
        const books = [
          { title: "Clean Code", author: "Robert Martin" },
          { title: "Design Systems", author: "Alla Kholmatova" },
        ];
        const blogs = [
          { title: "Why Accessibility Matters", date: "2025-11-10" },
          { title: "My Learning Journey", date: "2025-11-05" },
        ];
        const videos = [
          {
            title: "Intro to HTML & CSS",
            duration: "12:30",
            uploadedBy: "Admin",
          },
          {
            title: "JavaScript for Beginners",
            duration: "18:45",
            uploadedBy: "Admin",
          },
        ];

        function render(containerId, items, type) {
          const container = document.getElementById(containerId);
          container.innerHTML = "";
          items.forEach((item) => {
            const card = document.createElement("div");
            card.className = "card";
            if (type === "course") {
              card.innerHTML = `<h3>${item.title}</h3><p>Progress: ${item.progress}</p>`;
            } else if (type === "book") {
              card.innerHTML = `<h3>${item.title}</h3><p>by ${item.author}</p>`;
            } else if (type === "blog") {
              card.innerHTML = `<h3>${item.title}</h3><p><small>${item.date}</small></p>`;
            } else if (type === "video") {
              card.innerHTML = `<h3>${item.title}</h3><p><strong>${item.duration}</strong></p><p><small>by ${item.uploadedBy}</small></p>`;
            }
            container.appendChild(card);
          });
        }

        render("course-list", courses, "course");
        render("book-list", books, "book");
        render("blog-list", blogs, "blog");
        render("video-list", videos, "video");

            // Actions
        document.getElementById("change-pwd").addEventListener("click", (e) => {
          e.preventDefault();
          const pwd = prompt("New password (6+ chars):");
          if (pwd && pwd.length >= 6) {
            const users = JSON.parse(localStorage.getItem("users") || "[]");
            const idx = users.findIndex((u) => u.email === user.email);
            if (idx !== -1) {
              users[idx].password = pwd;
              localStorage.setItem("users", JSON.stringify(users));
              localStorage.setItem("currentUser", JSON.stringify(users[idx]));
              alert("Password updated!");
            }
          }
        });

        const handleLogout = () => {
          if (confirm("Logout?")) {
            localStorage.removeItem("currentUser");
            window.location.href = "user-login.html";
          }
        };

        document.getElementById("logout").addEventListener("click", (e) => {
          e.preventDefault();
          handleLogout();
        });
    })();
    </script>
  </body>
</html>